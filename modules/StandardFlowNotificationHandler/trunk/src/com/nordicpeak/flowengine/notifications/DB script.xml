<DBScripts>
	<Script version="1">
		<Query>
			<![CDATA[
				CREATE TABLE `flow_familiy_notification_settings` (
				  `flowFamilyID` INTEGER UNSIGNED NOT NULL,
				  `sendStatusChangedUserSMS` BOOLEAN NOT NULL,
				  `sendExternalMessageReceivedUserSMS` BOOLEAN NOT NULL,
				  `sendFlowInstanceSubmittedUserSMS` BOOLEAN NOT NULL,
				  `sendFlowInstanceArchivedUserSMS` BOOLEAN NOT NULL,
				  `sendStatusChangedUserEmail` BOOLEAN NOT NULL,
				  `sendExternalMessageReceivedUserEmail` BOOLEAN NOT NULL,
				  `sendFlowInstanceSubmittedUserEmail` BOOLEAN NOT NULL,
				  `sendFlowInstanceArchivedUserEmail` BOOLEAN NOT NULL,
				  `flowInstanceSubmittedUserEmailSubject` VARCHAR(255),
				  `flowInstanceSubmittedUserEmailMessage` TEXT,
				  `flowInstanceArchivedUserEmailSubject` VARCHAR(255),
				  `flowInstanceArchivedUserEmailMessage` TEXT,
				  `sendExternalMessageReceivedManagerEmail` BOOLEAN NOT NULL,
				  `sendFlowInstanceAssignedManagerEmail` BOOLEAN NOT NULL,
				  `sendStatusChangedManagerEmail` BOOLEAN NOT NULL,
				  `sendFlowInstanceSubmittedManagerEmail` BOOLEAN NOT NULL,
				  `flowInstanceSubmittedManagerEmailAddress` VARCHAR(255),
				  PRIMARY KEY (`flowFamilyID`)
				)
				ENGINE = InnoDB;
			]]>
		</Query>		
	</Script>
	
	<Script version="2">
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_settings` DROP COLUMN `flowInstanceSubmittedManagerEmailAddress`,
				 ADD COLUMN `sendFlowInstanceSubmittedGlobalEmail` BOOLEAN NOT NULL AFTER `sendFlowInstanceSubmittedManagerEmail`,
				 ADD COLUMN `flowInstanceSubmittedGlobalEmailAddress` VARCHAR(255) AFTER `sendFlowInstanceSubmittedGlobalEmail`;
			]]>
		</Query>		
	</Script>
	
	<Script version="3">
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_settings` ADD COLUMN `flowInstanceSubmittedGlobalEmailAttachPDF` BOOLEAN NOT NULL AFTER `flowInstanceSubmittedGlobalEmailAddress`;
			]]>
		</Query>		
	</Script>
	
	<Script version="4">
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_settings` ADD COLUMN `flowInstanceSubmittedGlobalEmailSubject` VARCHAR(255) AFTER `flowInstanceSubmittedGlobalEmailAttachPDF`,
 				ADD COLUMN `flowInstanceSubmittedGlobalEmailMessage` TEXT AFTER `flowInstanceSubmittedGlobalEmailSubject`;
			]]>
		</Query>
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_settings` ADD COLUMN `flowInstanceArchivedNotLoggedInUserEmailMessage` TEXT AFTER `flowInstanceArchivedUserEmailMessage`;
			]]>
		</Query>
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_settings` ADD COLUMN `flowInstanceSubmittedNotLoggedInUserEmailMessage` TEXT AFTER `flowInstanceSubmittedUserEmailMessage`;
			]]>
		</Query>	
	</Script>
	
	<Script version="5">
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_settings` ADD COLUMN `flowInstanceSubmittedUserEmailAttachPDF` TINYINT(1) UNSIGNED NOT NULL AFTER `flowInstanceSubmittedNotLoggedInUserEmailMessage`;
			]]>
		</Query>
	</Script>
	
	<Script version="6">
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_settings` ADD COLUMN `flowInstanceSubmittedGlobalEmailAttachPDFAttachmentsSeparately` TINYINT(1) UNSIGNED NOT NULL AFTER `flowInstanceSubmittedGlobalEmailAttachPDF`;
			]]>
		</Query>
	</Script>
	
	<Script version="7">
		<Query>
			<![CDATA[
				UPDATE flow_familiy_notification_settings SET flowInstanceSubmittedUserEmailMessage = replace(flowInstanceSubmittedUserEmailMessage, "a src=", "a href=");
			]]>
		</Query>
		<Query>
			<![CDATA[
				UPDATE flow_familiy_notification_settings SET flowInstanceSubmittedNotLoggedInUserEmailMessage = replace(flowInstanceSubmittedNotLoggedInUserEmailMessage, "a src=", "a href=");
			]]>
		</Query>
		<Query>
			<![CDATA[
				UPDATE flow_familiy_notification_settings SET flowInstanceArchivedUserEmailMessage = replace(flowInstanceArchivedUserEmailMessage, "a src=", "a href=");
			]]>
		</Query>
				<Query>
			<![CDATA[
				UPDATE flow_familiy_notification_settings SET flowInstanceArchivedNotLoggedInUserEmailMessage = replace(flowInstanceArchivedNotLoggedInUserEmailMessage, "a src=", "a href=");
			]]>
		</Query>
				<Query>
			<![CDATA[
				UPDATE flow_familiy_notification_settings SET flowInstanceSubmittedGlobalEmailMessage = replace(flowInstanceSubmittedGlobalEmailMessage, "a src=", "a href=");
			]]>
		</Query>
		
	</Script>
	
	<Script version="8">
		<Query>
			<![CDATA[
				CREATE TABLE `flow_familiy_notification_setting_submitglobal` (
				  `flowFamilyID` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
				  `email` VARCHAR(255) NOT NULL,
				  PRIMARY KEY (`flowFamilyID`),
				  CONSTRAINT `FK_flow_familiy_notification_setting_submitglobal_1` FOREIGN KEY `FK_flow_familiy_notification_setting_submitglobal_1` (`flowFamilyID`)
				    REFERENCES `flow_familiy_notification_settings` (`flowFamilyID`)
				    ON DELETE CASCADE
				    ON UPDATE CASCADE
				)
				ENGINE = InnoDB;				
			]]>
		</Query>
		<Query>
			<![CDATA[
				INSERT INTO flow_familiy_notification_setting_submitglobal (SELECT flowFamilyID, flowInstanceSubmittedGlobalEmailAddress FROM flow_familiy_notification_settings WHERE flowInstanceSubmittedGlobalEmailAddress IS NOT NULL);				
			]]>
		</Query>
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_settings` DROP COLUMN `flowInstanceSubmittedGlobalEmailAddress`;								
			]]>
		</Query>
	</Script>
	
	<Script version="9">
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_setting_submitglobal` DROP PRIMARY KEY,
				 ADD PRIMARY KEY  USING BTREE(`flowFamilyID`, `email`);				
			]]>
		</Query>
	</Script>
	
	<Script version="10">
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_settings` ADD COLUMN `sendExternalMessageReceivedGlobalEmail` BOOLEAN NOT NULL AFTER `flowInstanceSubmittedGlobalEmailMessage`;
			]]>
		</Query>	    
		<Query>
			<![CDATA[
				CREATE TABLE `flow_familiy_notification_setting_extmessageglobal` (
				  `flowFamilyID` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
				  `email` VARCHAR(255) NOT NULL,
				  PRIMARY KEY (`flowFamilyID`),
				  CONSTRAINT `FK_flow_familiy_notification_setting_extmessageglobal_1` FOREIGN KEY `FK_flow_familiy_notification_setting_extmessageglobal_1` (`flowFamilyID`)
				    REFERENCES `flow_familiy_notification_settings` (`flowFamilyID`)
				    ON DELETE CASCADE
				    ON UPDATE CASCADE
				)
				ENGINE = InnoDB;			
			]]>
		</Query>
	</Script>
	
	<Script version="11">    
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_setting_extmessageglobal` DROP PRIMARY KEY, ADD PRIMARY KEY  USING BTREE(`flowFamilyID`, `email`);
			]]>
		</Query>
	</Script>
	
	<Script version="12">    
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_settings` ADD COLUMN `statusChangedUserEmailSubject` VARCHAR(255) AFTER `sendStatusChangedUserEmail`,
				 ADD COLUMN `statusChangedUserEmailMessage` TEXT AFTER `statusChangedUserEmailSubject`,
				 ADD COLUMN `externalMessageReceivedUserEmailSubject` VARCHAR(255) AFTER `sendExternalMessageReceivedUserEmail`,
				 ADD COLUMN `externalMessageReceivedUserEmailMessage` TEXT AFTER `externalMessageReceivedUserEmailSubject`,
				 ADD COLUMN `externalMessageReceivedManagerSubject` VARCHAR(255) AFTER `sendExternalMessageReceivedManagerEmail`,
				 ADD COLUMN `externalMessageReceivedManagerMessage` TEXT AFTER `externalMessageReceivedManagerSubject`;
			]]>
		</Query>
	</Script>
	
	<Script version="13">
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_settings` ADD COLUMN `flowInstanceSubmittedGlobalEmailAttachXML` BOOLEAN NOT NULL AFTER `flowInstanceSubmittedGlobalEmailAttachPDF`;
			]]>
		</Query>
	</Script>
	
	<Script version="14">
		<Query>
			<![CDATA[
				CREATE TABLE `flow_familiy_notification_setting_managerexpiredglobal` (
					`flowFamilyID` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
					`email` VARCHAR(255) NOT NULL,
					PRIMARY KEY (`flowFamilyID`, `email`),
					CONSTRAINT `FK_flow_familiy_notification_setting_managerexpiredglobal_1` FOREIGN KEY (`flowFamilyID`) REFERENCES `flow_familiy_notification_settings` (`flowFamilyID`) ON UPDATE CASCADE ON DELETE CASCADE
				)
				COLLATE='latin1_swedish_ci'
				ENGINE=InnoDB;
			]]>
		</Query>
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_settings` ADD COLUMN `sendManagerExpiredGlobalEmail` TINYINT(1) NOT NULL AFTER `sendExternalMessageReceivedGlobalEmail`;
			]]>
		</Query>
	</Script>
	
	<Script version="15">
		<Query>
			<![CDATA[
				ALTER TABLE `flow_familiy_notification_settings`
					ADD COLUMN `flowInstanceSubmittedUserSMS` VARCHAR(255) NULL AFTER `sendFlowInstanceArchivedUserEmail`,
					ADD COLUMN `flowInstanceSubmittedNotLoggedInUserSMS` VARCHAR(255) NULL AFTER `flowInstanceSubmittedUserSMS`;
			]]>
		</Query>
	</Script>
	
</DBScripts>